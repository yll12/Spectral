h=2.5e-3;

rho=5300;  

C(1,1) = 23.9e10; 
C(1,2) = 10.4e10; 
C(1,3) = 5e10; 
C(2,2) = 24.7e10;  
C(2,3) = 5.2e10; 
C(3,3) = 13.5e10; 
C(4,4) = 6.5e10;   
C(5,5) = 6.6e10;   
C(6,6) = 7.6e10;

Vt=sqrt(C(6,6)/rho); 

N=90;
    
[x,D]=chebdif(N,2);
x=x*h;
D1=(h^-1)*D(:,:,1);
D2=(h^-2)*D(:,:,2);

O=zeros(N);

k=0;

xi=k.*2*h; %range of x to be plotted

m=0;

L11=D2*C(2,2)-k(1,(m+1))^2*C(4,4)*eye(N);
L12=D1*1i*k(1,(m+1))*(C(2,3)+C(4,4));
L22=-k(1,(m+1))^2*C(3,3)*eye(N)+D2*C(4,4);

Lp=[L11, L12; L12, L22];

L=Lp;

S11=C(2,2)*D1;
S12=C(2,3)*1i*k(1,(m+1))*eye(N);
S21=C(4,4)*1i*k(1,(m+1))*eye(N);
S22=C(4,4)*D1;


S=[S11, S12; S21, S22];

L(1,:)=S(1,:);
L(N,:)=S(N,:);
L((N+1),:)=S((N+1),:);
L((2*N),:)=S((2*N),:);

Mp=-rho*eye(N); Mp(1,1)=0; Mp(N,N)=0;

M=[Mp, O; O, Mp];

[P,E]=eig(L,M);
w=(sqrt(diag(E)));
w=w(imag(w) == 0);
w=sort(w);
