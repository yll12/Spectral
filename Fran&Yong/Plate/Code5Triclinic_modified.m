h=2.5e-3;

rho=8938.4; 

C(1,1) = 20.787e10;  
C(1,2) = 10.906e10; 
C(1,3) = 9.341e10; 
C(1,4) = 1.6574e10;
C(1,5) = -1.615e10;
C(1,6) = -2.3188e10; 
C(2,2) = 16.77e10;  
C(2,3) = 13.624e10; 
C(2,4) = -2.4719e10;
C(2,5) = 1.128e10;
C(2,6) = 0.86831e10;
C(3,3) = 18.591e10;     
C(3,4) = 0.81453e10;
C(3,5) = 0.82076e10;
C(3,6) = 1.4505e10;
C(4,4) = 10.023e10;   
C(4,5) = 1.4505e10;
C(4,6) = 0.58388e10;
C(5,5) = 3.5110e10;   
C(5,6) = 1.6574e10;
C(6,6) = 5.9472e10;


Vt=sqrt(5.9472e10/rho); 

N=70;

[x,D]=chebdif(N,2);
x=x*h;
D1=(h^-1)*D(:,:,1);
D2=(h^-2)*D(:,:,2);

O=zeros(N);

k=0;
xi=(kmax^3)*2*h; 

m=0;

L11= -k(1,(m+1))^2*C(5,5)*eye(N) +2*C(5,6)*1i*k(1,(m+1))*D1            +C(6,6)*D2; 
L12= -k(1,(m+1))^2*C(4,5)*eye(N) +(C(4,6)+C(2,5))*1i*k(1,(m+1))*D1 +C(2,6)*D2; 
L13= -k(1,(m+1))^2*C(3,5)*eye(N) +(C(3,6)+C(4,5))*1i*k(1,(m+1))*D1 +C(4,6)*D2; 

L22= -k(1,(m+1))^2*C(4,4)*eye(N) +2*C(2,4)*1i*k(1,(m+1))*D1        +C(2,2)*D2; 
L23= -k(1,(m+1))^2*C(3,4)*eye(N) +(C(2,3)+C(4,4))*1i*k(1,(m+1))*D1 +C(2,4)*D2; 

L33= -k(1,(m+1))^2*C(3,3)*eye(N) +2*C(3,4)*1i*k(1,(m+1))*D1        +C(4,4)*D2; 

Lp=[L11, L12, L13; L12, L22, L23; L13, L23, L33];

L=Lp;

S11= C(2,6)*D1 + 1i*k(1,(m+1))*C(2,5)*eye(N);
S12= C(2,2)*D1 + 1i*k(1,(m+1))*C(2,4)*eye(N);
S13= C(2,4)*D1 + 1i*k(1,(m+1))*C(2,3)*eye(N);

S21= C(4,6)*D1 + 1i*k(1,(m+1))*C(4,5)*eye(N);
S22= C(2,4)*D1 + 1i*k(1,(m+1))*C(4,4)*eye(N);
S23= C(4,4)*D1 + 1i*k(1,(m+1))*C(3,4)*eye(N);

S31= C(6,6)*D1 + 1i*k(1,(m+1))*C(5,6)*eye(N);
S32= C(2,6)*D1 + 1i*k(1,(m+1))*C(4,6)*eye(N);
S33= C(4,6)*D1 + 1i*k(1,(m+1))*C(3,6)*eye(N);

S=[S31, S32, S33; S11, S12, S13; S21, S22, S23];


L(1,:)=S(1,:);
L(N,:)=S(N,:);

L((N+1),:)=S((N+1),:);
L((2*N),:)=S((2*N),:);

L(((2*N)+1),:)=S(((2*N)+1),:);
L((3*N),:)=S((3*N),:);

Mp=-rho*eye(N); Mp(1,1)=0; Mp(N,N)=0;

M=[Mp, O, O; O, Mp, O; O, O, Mp];


[P,E]=eig(L,M);
w=sort(real(sqrt(diag(E))));